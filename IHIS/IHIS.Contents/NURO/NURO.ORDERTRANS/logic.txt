
[로직 재점검] ticket #412
  - 오더 데이터에 수납일자를 로깅하는 것에 대한 로직 변경
  
  AS-IS : 회계처리(전송) 후에 수납일자를 세팅하여 회계처리 이후의 변경을 못하게 하는 역할을 하였다.
  TO-BE : 약처방의 경우 N-DAY 처방에 대해 일자별로 회계처리를 하고 최종일의 회계처리에서 수납일자를 세팅하게 한다.

  WHY   : N-DAY의 약처방을 일별로 회계처리 하였을 때 초일에 수납일자가 세팅되어 오더 중지 및 변경 처리를 할 수가 없는 문제가 발생하였다.
  
  변경된 로직 : 회계전송 및 오더 중지/변경 처리 후에 N-DAY 미전송 처리 오더의 유무를 체크하여 수납일자를 세팅한다.

  추가 확인이 필요한 로직
  - 약처방과 주사처방의 경우 실제 투약 처리한 오더만 회계처리 할 수 있도록 하면서 투약기록에 회계전송 처리 정보를 세팅하고 있다.
    : 회계전송 마스터, 회계전송일
  
  - 전송 내역의 오더 키는 오더 중지/변경에 의해 새로 생성되는 키와의 매핑이 안되는 문제가 있다.
    따라서, 전송 내역의 키는 오더 중지/변경이 되는 원래의 오더키로 생성한다. 이후 전송 내역과의 오더키 매핑은 최상위 오더키로 처리한다.
    최상위 오더키는 오더 내역의 컬럼 [OCS2003.SOURCE_OCS2003] 으로 찾아낸다.
  
  - 오더 전송 화면에서의 조회 로직
    미전송 조회에서는 N-DAY 약처방 및 주사처방의 투약기간 내에 일자 단위로 오더의 미실시 여부와 실시된 오더의 미전송 여부를 체크하여 조회한다.
    전송된 내역의 경우는 N-DAY 약처방 및 주사처방의 경우 투약기록에 있는 전송마스터키와 매핑되는 오더를 조회한다.
  
  - 오더 전송/취소 로직
    미전송 오더의 전송 요청은 화면단에서 전송 대상 오더를 마킹한다. : 전송마스터키, 수납일자
    - 전송마스터 생성, 전송마스터키를 오더에 세팅 및 투약기록에 세팅한다.
      전송내역(트리거)에서 약처방 및 주사처방의 경우 오더의 수납일자를 재 설정한다.
    전송 내역의 전송성공여부 표시
    - 전송마스터 기준으로 오더 내역을 조회하고, 해당 오더의 최상의 오더키로 전송내역을 체크하여 전송성공여부를 표시한다.
    전송 취소처리
    - 전송마스터 단위로 전송내역을 취소 플래그를 세팅하여 전송처리한다.
      취소요청의 결과를 전송내역(트리거)에서 전송내역의 오더키에 해당하는 하위 오더내역 및 투약기록에 그 결과를 세팅한다.